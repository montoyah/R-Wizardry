---
title: "R wizardry Homework 3, 2017"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r, echo=FALSE, include=FALSE}
rm(list=ls(all=TRUE))

#setwd("/home/oscar/Dropbox/R wizardry TA/Day 4")
data <- read.csv("/home/oscar/Dropbox/R wizardry/2017/Datasets/compounds_triplicates_long.csv", header=T, stringsAsFactors = FALSE)
head(data)
unique(data$day)
```


# Question 1a (1 point) 
Four volunteers assited Willy Wonka and Chuck Norris with the methane measurements: “Tom”, “Jerry”, “Sylvester”, and “Tweety” alternated sampling each sample number in the “compounds_triplicates_long.csv” dataset. Create a new data column that reflects this. 

```{r, echo=FALSE, include=FALSE}
data$Volunteer <- rep(c("Tom","Jerry","Sylvester","Tweety"),1000)[1:length(data$day)]

head(data)
```


# Question 1b (2 points)
Upon reviewing your notes from this experiment, you discover that the volunteer “Tom” was confused about the procedure measuring all brackish and saline experimental groups on day 10, 86, and 116. Using 1 line of code, change the methane and standard deviation data for these measurements to NA. Then proceed to chastise Tom.

```{r, echo=FALSE, include=FALSE}
data[(data$Volunteer=="Tom" & 
        (data$salinity=="brackish" | data$salinity=="saline"))& 
       (data$day==10 | data$day==86 | data$day == 116),c("mean_methane","sd_methane")] <- NA
```



# Question 2 (2 points)
You have collected data for the methane production for each day for multiple compounds, treatment types, and saline treatments. Calculate and create two new columns in your dataset for the upper and lower 95% confidence intervals for each sample. The 95% confidence intervals are the methane production +/- 1.96 times the standard deviation for that sample.

```{r, echo=FALSE, include=FALSE}
data$Upper <- data$mean_methane + 2 * data$sd
data$Lower <- data$mean_methane - 2 * data$sd
```


# Question 3a (1 points)
Using a premade function in R, find the mean methane production per day for each compound-by-group-by-day combination accounting for missing data. Save and export this table as a .csv to your working directory.

```{r, echo=FALSE, include=FALSE}
ag <- aggregate(mean_methane ~ compound + group + day, FUN=mean, data=data, na.rm=T)

#write.csv(ag, "file_name.csv", row.names = FALSE)
```


# Question 3b (2 points)
Create a boxplot showing the uncertainty in mean 
#methane production per day for the Carbazole and Anthracene compounds (i.e., 
combine the methane production for both compounds).

```{r, echo=FALSE, include=FALSE}
boxplot(mean_methane ~ day, data=ag[ag$compound=="hexane" | ag$compound=="benzene",])
```


# Question 4 (2 points)
Find the indices for where in the data methane production was greater than 3.5 but the standard deviation was less than or equal to 2 on day 1. Whoever ran the unamendend saline water part of this experiment did so perfectly and will merit coauthorship, but which one of your volunteers deserves this honor?

```{r, echo=FALSE, include=FALSE}
data[which(data$mean_methane > 3.5 &
             data$sd <= 2 &
             data$day == 1 & 
             data$compound == "unamended" & 
             data$salinity == "saline"),]


```



<!--

## Question 5
Create a table using tapply, calculating the mean methane for the toluene compound for day 1 across all 3 salinity treatments, rounded to 1 significant figure. Write this table as a csv.
Hint: use the dataset used before we calculated mean and sd.

```{r, eval=FALSE}
?tapply
help("tapply")

unique(data_stats$compound)
temp <- tapply(data$methane_umoles[data$day == 1 & data$compound == "toluene"],
               data$salinity[data$day == 1 & data$compound == "toluene"], 
               mean)


subdata <- data[data$day == 1 & data$compound == "toluene",]

temp <- tapply(subdata$methane_umoles, subdata$salinity, mean, na.rm = T)
temp

write.csv(temp, "Toluene.csv")
```

-->

