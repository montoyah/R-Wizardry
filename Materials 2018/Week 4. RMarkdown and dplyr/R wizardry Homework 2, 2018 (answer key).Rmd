---
title: "R wizardry Homework 2, 2018"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message= FALSE)
```


```{r, echo=FALSE, include=FALSE}
rm(list=ls(all=TRUE))

#setwd("/home/oscar/Dropbox/R wizardry TA/Day 4")
data <- read.csv("/home/oscar/MEGAsync/R Wizardry/Materials 2018/Week 3/compounds_stats.csv", header=T, stringsAsFactors = FALSE)

compounds_stats <- data
compound_stats <- data
compounds <- data
df <- data
comp_stats <- data

head(data, 20)
unique(data$day)
```


# Question 1a (1 point) 
Four volunteers assited Willy Wonka and Chuck Norris with the methane measurements: “Tom”, “Jerry”, “Sylvester”, and “Tweety” alternated sampling each methane observation in the “compounds_stats" dataset. Create a new data column that reflects this. 

```{r, echo=FALSE, include=TRUE}
data$Volunteer <- rep(c("Tom","Jerry","Sylvester","Tweety"),1000)[1:length(data$day)]

head(data)
```


# Question 1b (3 points)
Upon reviewing your notes from this experiment, you discover that the volunteer “Tom” was confused about the procedure measuring all brackish and saline experimental groups on day 10, 86, and 116. Using 1 line of code, change the methane and standard deviation data for these measurements to NA. Then proceed to chastise Tom.

```{r, echo=FALSE, include=TRUE}
library(dplyr)
data[data$Volunteer=="Tom" &
        (data$salinity=="brackish" | data$salinity=="saline") & 
       (data$day==10 | data$day==86 | data$day == 116),
     c("methane_mean","methane_sd")] <- NA 

#To show answer in questionnaire
head(data[(data$Volunteer=="Tom" &
        (data$salinity=="brackish" |
        data$salinity=="saline"))& 
       (data$day==10 | data$day==86 | data$day == 116), ], 10)



compounds_alt <- data
head(compounds_alt)
compounds_alt[compounds_alt$Volunteer == "Tom" &
                (compounds_alt$day == 10 | compounds_alt$day == 86 |compounds_alt$day == 116) & (compounds_alt$salinity == "saline"|compounds_alt$salinity == "brackish"), ]

```



# Question 2 (2 points)
You have collected data for the methane production for each day for multiple compounds, treatment types, and saline treatments. Calculate and create two new columns in your dataset for the upper and lower 95% confidence intervals for each sample. The 95% confidence intervals are the methane production +/- 1.96 times the standard deviation for that sample.

```{r, echo=FALSE, include=TRUE}
head(data)
data$Upper <- data$methane_mean + 1.96 * data$methane_sd
data$Lower <- data$methane_mean - 1.96 * data$methane_sd
head(data, 15)

```

<!--
# Question 3a (1 points)
Using a premade function in R, find the mean methane production per day for each compound-by-group-by-day combination accounting for missing data. Save and export this table as a .csv to your working directory.

```{r, echo=FALSE, include=FALSE, eval=FALSE}
ag <- aggregate(mean_methane ~ compound + group + day, FUN=mean, data=data, na.rm=T)

#write.csv(ag, "file_name.csv", row.names = FALSE)
```
-->

\newpage

# Question 3 (3 points)
Create a boxplot showing the uncertainty in mean 
methane production per day for the hexane and benzene compounds (i.e., 
combine the methane production for both compounds).

```{r, echo=FALSE, include=TRUE}
?boxplot

boxplot(methane_mean ~ day, 
        data=data[data$compound=="hexane" | data$compound=="benzene", ],
        main = "Uncertainty in mean of methane \nproduction for hexane and benzene", 
        xlab = "Time (days)", 
        ylab = "Mean of methane production (umoles/day)")

```


# Question 4 (1 point)
Using R code, find the indices for where in the data methane production was greater than 3.5 but the standard deviation was less than or equal to 2 on day 1. Whoever ran the unamendend saline water part of this experiment did so perfectly that will merit coauthorship, but which one of your volunteers deserves this honor?

```{r, echo=FALSE, include=TRUE}
data[which(data$methane_mean > 3.5 &
             data$methane_sd <= 2 &
             data$day == 1 & 
             data$compound == "unamended" & 
             data$salinity == "saline"),]

```


<!--

## Question 5 (1 point)
Create a table using tapply, calculating the mean methane for the toluene compound for day 1 across all 3 salinity treatments, rounded to 1 significant figure.
Hint: use the dataset used before we calculated mean and sd.

```{r, eval=FALSE, echo=TRUE}

unique(compounds_stats$compound)
temp <- tapply(compounds_stats$methane_umoles[compounds_stats$day == 1 & 
                                          compounds_stats$compound == "toluene"],
               compounds_stats$salinity[compounds_stats$day == 1 & 
                                          compounds_stats$compound == "toluene"], 
               mean)


subdata <- compounds[compounds$day == 1 & compounds$compound == "toluene",]

temp <- tapply(subdata$methane_umoles, subdata$salinity, mean, na.rm = T)
temp

```

-->

