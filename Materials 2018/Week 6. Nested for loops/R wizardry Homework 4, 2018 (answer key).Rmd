---
title: "R wizardry Homework 3, 2018"
output:
  word_document: default
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, warning=FALSE, message= FALSE)
```

```{r, echo=FALSE, include=FALSE}
rm(list=ls(all=TRUE))
#setwd("/Admin/desktop/R/Datasets/")
data = read.csv("/home/oscar/MEGAsync/R Wizardry/Materials 2018/Datasets/SimDataTrend.csv")
head(data)
```

# Question 1 (1 point) 
For the following code fill in the values of the variables at the end of each iteration of the inner loop (What the value would be right before hitting the marked curly bracket). This is tedious, but it should help you understand what a for loop is doing by manually runing through it. Hint: If you need help, print()

1st end of inner loop
count = 
i = 
j = 
results = 
sequence = 

2nd end of inner loop
count = 
i = 
j = 
results = 
sequence = 

3rd end of inner loop
count = 
i = 
j = 
results = 
sequence = 

4th end of inner loop
count = 
i = 
j = 
results = 
sequence = 

```{r, eval=FALSE, include=TRUE}
sequence1 <- c(1,3)
sequence2 <- c(4,2)
results <- NULL
count <- 0

for(i in sequence1){
  for(j in sequence2){
    count <- count + 1
    results[count] <- i + j
  } # end of inner loop
}

results
```

# Question 2 (3 points)


```{r, echo=FALSE, include=TRUE}

```

# Question 3 (4 points)
Convert the biomass data into an n-dimensional array, with a dimension for each categorical variable with different levels for year, day, block, nutrient, and genotypic richness (there are 3 levels of richness: either 1, 3, or 5). Hint - Make an empty array of appropriately sized dimensions first. Then use nested FOR loops to loop through the data, grabbing the biomass data at the appropriate numeric index to fill the array for when the year equals year y, the day equals day d, the block equals block b, the nutrient treatment equals treatment n, and the genotypic richness equals genotype g.

```{r, echo=FALSE, include=TRUE}
biomass = array(NA, dim = c(length(unique(data$year)),
                            length(unique(data$day)), 
                            length(unique(data$block)), 
                            length(unique(data$nutrient)), 
                            length(unique(data$geno))))
dim(biomass)

for(y in seq_along(unique(data$year)))
  for(d in seq_along(unique(data$day)))
    for(b in seq_along(unique(data$block)))
      for(n in seq_along(unique(data$nutrient)))
        for(g in seq_along(unique(data$geno)))
        {
          biomass[y,d,b,n,g] = data$biomass[data$year == unique(data$year)[y] & 
                                              data$day == unique(data$day)[d] & 
                                              data$block == unique(data$block)[b] & 
                                              data$nutrient == unique(data$nutrient)[n] & 
                                              data$geno == unique(data$geno)[g]]
        }
```

#Question 4 (2 points)
Converting the data frame into an array allowed us to make nice contour plots to visualized general patterns in the data. We can more easily do this once we index the array down into a matrix. Make a contour plot (see code below) by indexing the array for the first year, the first block, and the "Treatment" nutrient group (Treatment is the 2nd level of "nutrients"). If you recall, we are "slicing" through the array to pull out a data matrix. Plot how biomass changes over the day of year for each genotypic richness level. We can see then that generally, increased genotypic richness leads to slightly higher biomass. Also, biomass tends to increase as time increases.

filled.contour(DATA OF INTEREST, xlab = "Day of Year", ylab = "Genotype Richness", x = UNIQUE LEVELS OF DAY, 
y = UNIQUE LEVELS OF GENOTYPIC RICHNESS, color.palette= heat.colors)
```{r, eval=FALSE, include=FALSE}
temp = biomass[1, , 1, 2,]

#Plot the matrix with the colour representing the value of biomass
filled.contour(temp, xlab = "Day of Year", ylab = "Genotype Richness", x = unique(data$day), y = unique(data$geno), color.palette= heat.colors)
```
